# Preamble
**Prompt:**  
You are a physicist helping me to construct Hamiltonian step by step based on my instructions.  
You should follow the instruction strictly and reply succinctly without trying to expand any unwanted content.  
You should stop me if you find any contradictory instructions, and point them out to me.  
You will be learning background knowledge by examples if necessary.
Confirm if you understand it.  

**Completion:**  
I understand my duties as a physicist helping you to construct Hamiltonian and perform Hartree-Fock step by step based on your instructions. I will follow your instructions strictly and provide succinct, complete replies that do not expand on unwanted content. I will learn background knowledge by examples if necessary.

To confirm, I will:

* Construct the Hamiltonian based on your instructions.
* Perform Hartree-Fock calculations on the Hamiltonian.
* Provide you with the results of the Hartree-Fock calculations.

Do you have any specific instructions for me to start?

# Hamiltonian construction

## Construct Kinetic Hamiltonian
**Prompt:**  
You will be instructed to describe the kinetic term of Hamiltonian in the hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form. 
The degrees of freedom of the system are: valley index (+K and -K valley), layer index (top and bottom layer).  
Express the Kinetic Hamiltonian $H_{Kinetic}(r)$ using $E_{\tau,l}$ which are only on the diagonal terms, and arrange the basis in the order of (+K,bottom), (+K,top), (-K,bottom), (-K,top).  

Use the following conventions for the symbols:  
$l$ : layer index  
$t$ : top layer  
$b$ : bottom layer  
$\tau$ : valley index  
$+K$ : +K valley  
$-K$ : -K valley  
$E_{\tau,l}$ : energy dispersion for valley $\tau$ and layer $l$  
$H_{Kinetic}(r)$ : kinetic term of Hamiltonian in the real space in the single-particle form  

**Completion:**  
Sure, I can help you with that.

The kinetic Hamiltonian for the hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form can be expressed as follows:

$H_{Kinetic}(r) = \left(
\begin{array}{cccc}
E_{+K,b} & 0 & 0 & 0 \\
0 & E_{+K,t} & 0 & 0 \\
0 & 0 & E_{-K,b} & 0 \\
0 & 0 & 0 & E_{-K,t} \\
\end{array}
\right)$

where $E_{\tau,l}$ is the energy dispersion for valley $\tau$ and layer $l$. The basis is arranged in the order of (+K,bottom), (+K,top), (-K,bottom), (-K,top).

The reason why the kinetic Hamiltonian is only on the diagonal terms is because the hole-doped AB-stacked MoTe2/WSe2 is a two-dimensional system, and there is no coupling between different momentum states.

I hope this helps! Let me know if you have any other questions.

## Define each term in Kinetic Hamiltonian
**Prompt:**  
Now you will be instructed to construct each term in the matrix, namely the energy dispersion $E_{l,\tau}(k)$.  
For all energy dispersions, $E_{l,\tau}(k)$, it characterizes the dispersion for free holes, namely, $E_{l,\tau}(k)= -\frac{\hbar^2 k^2}{2 m_l}$.   
In addition, for the top layer, $E_{\tau,t}(k)$, there is a shift of momentum $k$, to make the band bottom at $\tilde{\tau}\kappa$.  
Finally, in the real space, the momentum $k=-i \partial_r$. You should keep the form of $k$ in the Hamiltonian for short notations but should remember $k$ is an operator.  
Return the expression for four $E_{l,\tau}(k)$ in the Kinetic Hamiltonian, and substitute it into the Kinetic Hamiltonian $H_{Kinetic}$  

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encountered undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):
$k$ : momentum operator  
$r$ : real space operator  
$m_l$ : the effective mass for layer $l$  
$\tilde{\tau}$ : takes value of +1 for $\tau=+K$ and -1 for $\tau=-K$  
$\pm\kappa$ : corners of monolayer moire Brillouin zone  

**Completion:**  

Sure, I can help you with that.

The energy dispersion for free holes is given by:

$E_{l,\tau}(k) = -\frac{\hbar^2 k^2}{2 m_l}$

where $l$ is the layer index, $\tau$ is the valley index, $k$ is the momentum, and $m_l$ is the effective mass for layer $l$.

For the top layer, the momentum is shifted by $\tilde{\tau}\kappa$, so the energy dispersion for the top layer is given by:

$E_{\tau,t}(k) = -\frac{\hbar^2 (k - \tilde{\tau}\kappa)^2}{2 m_t}$

where $\tilde{\tau}$ takes the value of +1 for $\tau = +K$ and -1 for $\tau = -K$.

The kinetic Hamiltonian for the hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form can now be expressed as follows:

$H_{Kinetic}(r) = \left(
\begin{array}{cccc}
E_{+K,b} & 0 & 0 & 0 \\
0 & E_{+K,t} - \tilde{+K}\kappa^2 & 0 & 0 \\
0 & 0 & E_{-K,b} & 0 \\
0 & 0 & 0 & E_{-K,t} - \tilde{-K}\kappa^2 \\
\end{array}
\right)$

where $E_{\tau,l}$ is the energy dispersion for valley $\tau$ and layer $l$. The basis is arranged in the order of (+K,bottom), (+K,top), (-K,bottom), (-K,top).

I hope this helps! Let me know if you have any other questions.

## Define each term in Kinetic Hamiltonian (Revised)
**Prompt:**  
Now you will be instructed to construct each term in the matrix, namely the energy dispersion $E_{l,\tau}(k)$.  
For all energy dispersions, $E_{l,\tau}(k)$, it characterizes the dispersion for free holes, namely, $E_{l,\tau}(k)= -\frac{\hbar^2 k^2}{2 m_l}$.   
In addition, for the top layer, $E_{\tau,t}(k)$, there is a shift of momentum $k$, to make the band bottom at $\tilde{\tau}\kappa$. **[Namely, $E_{l,\tau}(k)= -\frac{\hbar^2 (k-\tilde{\tau}\kappa)^2}{2 m_l}$.]**  
Finally, in the real space, the momentum $k=-i \partial_r$. You should keep the form of $k$ in the Hamiltonian for short notations but should remember $k$ is an operator.  
Return the expression for four $E_{l,\tau}(k)$ in the Kinetic Hamiltonian, and substitute it into the Kinetic Hamiltonian $H_{Kinetic}$  

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encountered undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):
$k$ : momentum operator  
$r$ : real space operator  
$m_l$ : the effective mass for layer $l$  
$\tilde{\tau}$ : takes value of +1 for $\tau=+K$ and -1 for $\tau=-K$  
$\pm\kappa$ : corners of monolayer moire Brillouin zone  

**Completion:**  

Sure, I can help you with that.

The energy dispersion for the hole-doped AB-stacked MoTe2/WSe2 in the real space can be expressed as follows:

$E_{l,\tau}(k) = -\frac{\hbar^2 (k - \tilde{\tau}\kappa)^2}{2 m_l}$

where $k$ is the momentum operator, $r$ is the real space operator, $m_l$ is the effective mass for layer $l$, $\tilde{\tau}$ takes value of +1 for $\tau=+K$ and -1 for $\tau=-K$, and $\pm\kappa$ are the corners of monolayer moire Brillouin zone.

The kinetic Hamiltonian for the hole-doped AB-stacked MoTe2/WSe2 can then be expressed as follows:

$H_{Kinetic}(r) = \left(
\begin{array}{cccc}
-\frac{\hbar^2 k^2}{2 m_b} & 0 & 0 & 0 \\
0 & -\frac{\hbar^2 (k-\kappa)^2}{2 m_t} & 0 & 0 \\
0 & 0 & -\frac{\hbar^2 k^2}{2 m_b} & 0 \\
0 & 0 & 0 & -\frac{\hbar^2 (k+\kappa)^2}{2 m_t} \\
\end{array}
\right)$

where the basis is arranged in the order of (+K,bottom), (+K,top), (-K,bottom), (-K,top).

I hope this helps! Let me know if you have any other questions.


## Construct Potential Hamiltonian
**Prompt:**  
Now you will be instructed to describe the potential term of Hamiltonian $H_{Potential}(r)$ in the real space in the single particle form.  
The potential Hamiltonian has the same degrees of freedom as the kinetic Hamiltonian $H_{Kinetic}(r)$.  
At each valley, it is a 2 by 2 matrix $H_{Potential,\tau}(r)$, where each component is layer index. The diagonal term in this 2 by 2 matrix $H_{Potential,\tau}(r)$ is  intralayer tunneling $\Delta_l(r)$. The off-diagonal term in this 2 by 2 matrix $H_{Potential,\tau}(r)$ is interlayer potential $\Delta_{T,\tau}(r)$, which should be kept hermitian.   
There is no hybridization between $+K$ valley and $-K$ valley, i.e., the corresponding matrix elements in $H_{Potential}(r)$ are all zero.  
Express the potential Hamiltonian $H_{Potential}(r)$ using $\Delta_l(r)$ and $\Delta_{T,\tau}(r)$.  

Use the following conventions for the symbols (You should also remember the conventions in my previous prompts if there are no conflicts. If you have conflicts in the conventions, you should stop and let me know):  
$\Delta_l$: intralayer potential for layer index $l$  
$\Delta_{T,\tau}$ : interlayer tunneling at valley index $\tau$  
$H_{Potential}(r)$ : potential term of Hamiltonian in the real space in the single-particle form.  

**Completion:**  
Sure, I can help you with that.

The potential Hamiltonian for hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form can be expressed as follows:

$H_{Potential}(r) = \left(
\begin{array}{cccc}
\Delta_b(r) & 0 & 0 & 0 \\
0 & \Delta_t(r) & \Delta_{T,+K}(r) & 0 \\
0 & \Delta_{T,+K}(r) & \Delta_b(r) & 0 \\
0 & 0 & 0 & \Delta_t(r) \\
\end{array}
\right)$

where $\Delta_l(r)$ is the intralayer potential for layer $l$, and $\Delta_{T,\tau}(r)$ is the interlayer potential at valley index $\tau$.

The diagonal terms of the Hamiltonian represent the intralayer potential for holes in each layer. The off-diagonal terms represent the interlayer tunneling between holes in different layers.

The fact that there is no hybridization between $+K$ valley and $-K$ valley is reflected in the fact that the corresponding matrix elements in $H_{Potential}(r)$ are all zero.

This is the potential Hamiltonian for hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form.

I hope this is helpful! Let me know if you have any other questions.


## Construct Potential Hamiltonian (Revised)
**Prompt:**  
Now you will be instructed to describe the potential term of Hamiltonian $H_{Potential}(r)$ in the real space in the single particle form.  
The potential Hamiltonian has the same degrees of freedom as the kinetic Hamiltonian $H_{Kinetic}(r)$. Namely, it can be rewritten as $H_{Potential}(r)=\begin{pmatrix} H_{Potential,+K}(r) & 0 \\ 0 & H_{Potential,-K}(r) \end{pmatrix}$, where $H_{Potential,\tau}(r)$ is a 2 by 2 matrix for valley $\tau$.  
At each valley, it is a 2 by 2 matrix $H_{Potential,\tau}(r)$, where each component is layer index. The diagonal term in this 2 by 2 matrix $H_{Potential,\tau}(r)$ is  intralayer tunneling $\Delta_l(r)$. The off-diagonal term in this 2 by 2 matrix $H_{Potential,\tau}(r)$ is interlayer potential $\Delta_{T,\tau}(r)$, which should be kept hermitian. This means,  if you put $\Delta_{T,\tau}(r)$ on $i,j$ entry of the matrix, you should put $\Delta_{T,\tau}^*(r)$ on the $j,i$ entry of the matrix.
There is no hybridization between $+K$ valley and $-K$ valley, i.e., the corresponding matrix elements in $H_{Potential}(r)$ are all zero.  
Express the potential Hamiltonian $H_{Potential}(r)$ using $\Delta_l(r)$ and $\Delta_{T,\tau}(r)$.  

Use the following conventions for the symbols (You should also remember the conventions in my previous prompts if there are no conflicts. If you have conflicts in the conventions, you should stop and let me know):  
$\Delta_l$: intralayer potential for layer index $l$  
$\Delta_{T,\tau}$ : interlayer tunneling at valley index $\tau$  
$H_{Potential}(r)$ : potential term of Hamiltonian in the real space in the single-particle form.  

**Completion:**  
Sure, I can help you with that.

The potential Hamiltonian for hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form can be expressed as follows:

$H_{Potential}(r) = \left(
\begin{array}{cccc}
\Delta_b(r) & \Delta_{T,+K}(r) & 0 & 0 \\
\Delta_{T,+K}^*(r) & \Delta_t(r) & 0 & 0 \\
0 & 0 & \Delta_b(r) & \Delta_{T,-K}(r) \\
0 & 0 & \Delta_{T,-K}^*(r) & \Delta_t(r) \\
\end{array}
\right)$

where $\Delta_l$ is the intralayer potential for layer $l$, and $\Delta_{T,\tau}$ is the interlayer tunneling at valley index $\tau$.

The diagonal terms of the Hamiltonian represent the potential energy of the holes in each valley and layer. The off-diagonal terms represent the tunneling between holes in different layers.

Note that there is no hybridization between $+K$ valley and $-K$ valley, so the corresponding matrix elements in $H_{Potential}(r)$ are all zero.

I hope this is helpful! Let me know if you have any other questions.

## Define each term in Potential Hamiltonian
**Prompt:**  
Now you will be instructed to construct each term in the matrix $H_{Potential}(r)$, namely, the intralayer potential $\Delta_l(r)$ and interlayer tunneling $\Delta_{T,\tau}(r)$.  
The intralayer on the top layer $\Delta_t(r)$ is $V_{zt}$.  
The intralayer on the bottom layer $\Delta_b(r)$ is $2V_b\sum_{j=1,3,5} \cos(g_j \cdot r  +\psi_b)$.  
The interlayer tunneling at valley $\tau$ is $\tilde{\tau}w(1+\omega^{\tilde{\tau}}e^{i\tilde{\tau} g_2 \cdot r} + \omega^{2\tilde{\tau}} e^{i\tilde{\tau} g_3 \cdot r})$.  
Return the expressions for the intralayer potential $\Delta_t(r)$ and $\Delta_b(r)$ and interlayer tunneling $\Delta_{T,+K}(r)$ and $\Delta_{T,-K}(r)$, and substitute it into the potential Hamiltonian $H_{Potential}(r)$.  

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or have conflicts in the conventions, you should stop and let me know):  
$V_{zt}$ : displacement field on the top layer  
$V_b$ : bottom layer potential strength  
$\psi_b$ : bottom layer potential phase  
$g_j$ : reciprocal unit vector on the first shell corresponding in the moire Brillouin zone, j varies from 1 to 6.  
$r$ : real space position  
$\omega$ : phase factor to respect the threefold rotational symmetry, which is $e^{i2\pi/3}$, the hermitian conjugate is $\omega^{-1}=e^{i2\pi/3}$  
$w$ : interlayer tunneling strength  

**Completion:**  
Sure, I can help you with that.

The intralayer potential on the top layer is given by:

$\Delta_t(r) = V_{zt}$

The intralayer potential on the bottom layer is given by:

$\Delta_b(r) = 2V_b\sum_{j=1,3,5} \cos(g_j \cdot r  +\psi_b)$

The interlayer tunneling at valley $\tau$ is given by:


$\Delta_{T,\tau}(r) = \tilde{\tau}w(1+\omega^{\tilde{\tau}}e^{i\tilde{\tau} g_2 \cdot r} + \omega^{2\tilde{\tau}} e^{i\tilde{\tau} g_3 \cdot r})$


where $\tilde{\tau}$ takes the value of +1 for $\tau=+K$ and -1 for $\tau=-K$.

Substituting these expressions into the potential Hamiltonian, we get:


$H_{Potential}(r) = \left(
\begin{array}{cccc}
V_{zt} & \tilde{w}(1+\omega e^{i g_2 \cdot r} + \omega^2 e^{i g_3 \cdot r}) & 0 & 0 \\
\tilde{w}(1+\omega e^{-i g_2 \cdot r} + \omega^2 e^{-i g_3 \cdot r}) & 2V_b\cos(g_1 \cdot r + \psi_b) & 0 & 0 \\
0 & 0 & V_{zt} & \tilde{w}(1+\omega e^{-i g_2 \cdot r} + \omega^2 e^{-i g_3 \cdot r}) \\
0 & 0 & \tilde{w}(1+\omega e^{i g_2 \cdot r} + \omega^2 e^{i g_3 \cdot r}) & 2V_b\cos(g_1 \cdot r + \psi_b) \\
\end{array}
\right)$


This is the potential Hamiltonian for hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form.

I hope this is helpful! Let me know if you have any other questions.

## Define each term in Potential Hamiltonian (Revised)
**Prompt:**  


Now you will be instructed to construct each term in the matrix $H_{Potential}(r)$, namely, the intralayer potential $\Delta_l(r)$ and interlayer tunneling $\Delta_{T,\tau}(r)$.  
The intralayer on the top layer $\Delta_t(r)$ is $V_{zt}$.  
The intralayer on the bottom layer $\Delta_b(r)$ is $2V_b\sum_{j=1,3,5} \cos(g_j \cdot r  +\psi_b)$.  
The interlayer tunneling at valley $\tau$, $\Delta_{T,\tau}(r)$, is $\tilde{\tau}w(1+\omega^{\tilde{\tau}}e^{i\tilde{\tau} g_2 \cdot r} + \omega^{2\tilde{\tau}} e^{i\tilde{\tau} g_3 \cdot r})$. 
Return the expressions for the intralayer potential $\Delta_t(r)$ and $\Delta_b(r)$ and interlayer tunneling $\Delta_{T,+K}(r)$ and $\Delta_{T,-K}(r)$, and substitute it into the potential Hamiltonian $H_{Potential}(r)$.  

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or have conflicts in the conventions, you should stop and let me know):  
$V_{zt}$ : displacement field on the top layer  
$V_b$ : bottom layer potential strength  
$\psi_b$ : bottom layer potential phase  
$g_j$ : reciprocal unit vector on the first shell corresponding in the moire Brillouin zone, j varies from 1 to 6.  
$r$ : real space position  
$\omega$ : phase factor to respect the threefold rotational symmetry, which is $e^{i2\pi/3}$, the hermitian conjugate is $\omega^{-1}=e^{-i2\pi/3}$  
$w$ : interlayer tunneling strength  

**Completion:**  
Sure, I can help you with that.

The intralayer potential on the top layer is given by:

$\Delta_t(r) = V_{zt}$

The intralayer potential on the bottom layer is given by:

$\Delta_b(r) = 2V_b\sum_{j=1,3,5} \cos(g_j \cdot r  +\psi_b)$

The interlayer tunneling at valley $\tau$ is given by:


$\Delta_{T,\tau}(r) = \tilde{\tau}w(1+\omega^{\tilde{\tau}}e^{i\tilde{\tau} g_2 \cdot r} + \omega^{2\tilde{\tau}} e^{i\tilde{\tau} g_3 \cdot r})$


where $\tilde{\tau}$ takes the value of +1 for $\tau=+K$ and -1 for $\tau=-K$.

Substituting these expressions into the potential Hamiltonian, we get:

$H_{Potential}(r) = \left(
\begin{array}{cccc}
V_{zt} & \tilde{w}(1+\omega e^{i g_2 \cdot r} + \omega^2 e^{i g_3 \cdot r}) & 0 & 0 \\
\tilde{w}(1+\omega^{-1} e^{-i g_2 \cdot r} + \omega^{-2} e^{-i g_3 \cdot r}) & V_b & 0 & 0 \\
0 & 0 & V_{zt} & \tilde{w}(1+\omega e^{-i g_2 \cdot r} + \omega^2 e^{-i g_3 \cdot r}) \\
0 & 0 & \tilde{w}(1+\omega^{-1} e^{i g_2 \cdot r} + \omega^{-2} e^{i g_3 \cdot r}) & V_b \\
\end{array}
\right)$

This is the potential Hamiltonian for hole-doped AB-stacked MoTe2/WSe2 in the real space in the single-particle form.

I hope this is helpful! Let me know if you have any other questions.