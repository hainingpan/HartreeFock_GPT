# Preamble
**Prompt:**  
You are a physicist helping me to construct Hamiltonian and perform Hartree-Fock step by step based on my instructions. 
You should follow the instruction strictly.
Your reply should be succinct while complete. You should not expand any unwanted content.
You will be learning background knowledge by examples if necessary.
Confirm and repeat your duty if you understand it.

**Completion:**  

# Hamiltonian construction
## Construct Kinetic Hamiltonian (lattice version)
**Prompt:**  
You will be instructed to describe the kinetic term of Hamiltonian in CuO$_2$ in the real space in the second-quantized form.   
The degrees of freedom of the system are: spin index (spin up and spin down), orbital index ($d$ orbital in Cu atom, $p_x$ orbital in O atom, and $p_y$ orbital in O atom)  
The kinetic term is a tight-binding model composed of the following hopping process: 
1. $c_{d,s}^\dagger(R_i)$ and $c_{p_x,s}^\dagger(R_i+\hat{x}/2)$ with the hopping amplitude $-t_pd$.  
2. $c_{d,s}^\dagger(R_i)$ and $c_{p_x,s}^\dagger(R_i-\hat{x}/2)$ with the hopping amplitude $-t_pd$.  
3. $c_{d,s}^\dagger(R_i)$ and $c_{p_y,s}^\dagger(R_i+\hat{y}/2)$ with the hopping amplitude $-t_pd$.  
4. $c_{d,s}^\dagger(R_i)$ and $c_{p_y,s}^\dagger(R_i-\hat{y}/2)$ with the hopping amplitude $-t_pd$.  
5. $c_{p_x,s}^\dagger(R_i+\hat{x}/2)$ and $c_{p_y,s}^\dagger(R_i+\hat{y}/2)$ with the hopping amplitude $-t_pp$.  
6. $c_{p_x,s}^\dagger(R_i+\hat{x}/2)$ and $c_{p_y,s}^\dagger(R_i-\hat{y}/2)$ with the hopping amplitude $-t_pp$.  
7. $c_{p_x,s}^\dagger(R_i-\hat{x}/2)$ and $c_{p_y,s}^\dagger(R_i+\hat{y}/2)$ with the hopping amplitude $-t_pp$.  
8. $c_{p_x,s}^\dagger(R_i-\hat{x}/2)$ and $c_{p_y,s}^\dagger(R_i-\hat{y}/2)$ with the hopping amplitude $-t_pp$.  
You should ensure the hermiticity of the Hamiltonian.
The summation should be taken over all spin index and all real space positions.  
Return the Kinetic Hamiltonian $H_0$.

Use the following conventions for the symbols:  
$s$ : spin index  
$\uparrow$ : spin up  
$\downarrow$ : spin down 
$\alpha$ : orbital index
$d$: $d$ orbital in Cu atom
$p_x$: $p_x$ orbital in O atom
$p_y$: $p_y$ orbital in O atom
$c_{\alpha,s}^\dagger(R_i)$ : annihilation operator for a particle with orbital $\alpha$ and spin $s$ at site $i$ 
$R_i$ : real space position of site $i$  
$\hat{x}$: unit vector along $x$ direction
$\hat{y}$: unit vector along $y$ direction
$t_{pd}$: hopping amplitude between $p_x$ and $d$ orbital, or $p_y$ and $d$ orbital
$t_{pp}$: hopping amplitude between $p_x$ and $p_y$ orbital

**Completion:**  
Given the instructions, we can write down the kinetic Hamiltonian in second quantized form for the specified degrees of freedom, including the necessary summations over all spin indices and real space positions. The hermiticity of the Hamiltonian is ensured by including both the creation and annihilation processes for each hopping term.

The resulting Hamiltonian is:

$$
H_0 = -t_{pd}\sum_{R_i, s} ( c_{d,s}^\dagger(R_i) c_{p_x,s}(R_i+\hat{x}/2) + c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{d,s}(R_i) 
+ c_{d,s}^\dagger(R_i) c_{p_x,s}(R_i-\hat{x}/2) + c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{d,s}(R_i)
+ c_{d,s}^\dagger(R_i) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{d,s}(R_i)
+ c_{d,s}^\dagger(R_i) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{d,s}(R_i) )
-t_{pp}\sum_{R_i, s} ( c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{p_x,s}(R_i+\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{p_x,s}(R_i+\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{p_x,s}(R_i-\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{p_x,s}(R_i-\hat{x}/2) )
$$

Where $c_{\alpha,s}^\dagger(R_i)$ and $c_{\alpha,s}(R_i)$ represent the creation and annihilation operators, respectively, for a particle in orbital $\alpha$ with spin $s$ at site $R_i$. The spin index $s$ can take on values of $\uparrow$ (spin up) or $\downarrow$ (spin down). The orbital index $\alpha$ can take on values of $d$, $p_x$, or $p_y$ which correspond to the $d$ orbital in the Cu atom, $p_x$ orbital in the O atom, and $p_y$ orbital in the O atom, respectively. $t_{pd}$ is the hopping amplitude between $p$ and $d$ orbitals, and $t_{pp}$ is the hopping amplitude between $p_x$ and $p_y$ orbitals.


## Construct interaction Hamiltonian (lattice version)
**Prompt:**  
Now you will be instructed to construct the interaction part of the Hamiltonian, $\hat{H}^{int}$ in the real space in the second-quantized form.   
The interacting Hamiltonian has the same degrees of freedom as the kinetic Hamiltonian $H_0$.  
The interaction is a density-density interaction composed of the following process:
1. onsite interaction between $n_{d,\uparrow}(R_i)$ and $n_{d,\downarrow}(R_i)$ with interaction strength $U_d$
2. onsite interaction between $n_{p_x,\uparrow}(R_i+\hat{x}/2)$ and $n_{p_x,\downarrow}(R_i+\hat{x}/2)$ with interaction strength $U_p/2$
3. onsite interaction between $n_{p_y,\uparrow}(R_i+\hat{y}/2)$ and $n_{p_y,\downarrow}(R_i+\hat{y}/2)$ with interaction strength $U_p/2$
4. Nearest neighbor interaction between $n_{d,s}(R_i)$ and $n_{p_x,s^{\prime}}(R_i+\hat{x}/2)$ with interaction strength $V_{pd}$
5. Nearest neighbor interaction between $n_{d,s}(R_i)$ and $n_{p_x,s^{\prime}}(R_i-\hat{x}/2)$ with interaction strength $V_{pd}$
6. Nearest neighbor interaction between $n_{d,s}(R_i)$ and $n_{p_y,s^{\prime}}(R_i+\hat{y}/2)$ with interaction strength $V_{pd}$
7. Nearest neighbor interaction between $n_{d,s}(R_i)$ and $n_{p_y,s^{\prime}}(R_i-\hat{y}/2)$ with interaction strength $V_{pd}$
8. Nearest neighbor interaction between $n_{p_x,s}(R_i+\hat{x}/2)$ and $n_{p_y,s^{\prime}}(R_i+\hat{y}/2)$ with interaction strength $V_{pp}$
9. Nearest neighbor interaction between $n_{p_x,s}(R_i+\hat{x}/2)$ and $n_{p_y,s^{\prime}}(R_i-\hat{y}/2)$ with interaction strength $V_{pp}$
10. Nearest neighbor interaction between $n_{p_x,s}(R_i-\hat{x}/2)$ and $n_{p_y,s^{\prime}}(R_i+\hat{y}/2)$ with interaction strength $V_{pp}$
11. Nearest neighbor interaction between $n_{p_x,s}(R_i-\hat{x}/2)$ and $n_{p_y,s^{\prime}}(R_i-\hat{y}/2)$ with interaction strength $V_{pp}$  
where density operator $n_{\alpha,s}(R_i) = c_{\alpha,s}^\dagger(R_i) c_{\alpha,s}(R_i)$.    
The summation should be taken over all spin index and all real space positions.  
Return the interaction term $\hat{H}^{int}$ in terms of $n_{d,\uparrow}(R_i)$.

Use the following conventions for the symbols (You should also remember the conventions in my previous prompts if there are no conflicts. If you have conflicts in the conventions, you should stop and let me know):  
$s^{\prime}$: spin index  
$n_{\alpha,s}(R_i)$: density of particle with orbital $\alpha$ and spin $s$ at site $R_i$  
$U_d$: onsite interaction strength of $d$ orbital  
$U_p$: onsite interaction strength of $p_x$ orbital or $p_y$ orbital  
$V_{pd}$: Nearest neighbor interaction strength between $p_x$ orbital and $d$ orbital or between $p_y$ orbital and $d$ orbital  
$V_{pp}$: Nearest neighbor interaction strength between $p_x$ orbital and $p_y$ orbital  

**Completion:**  
Given the instructions, we can write down the interacting Hamiltonian in second quantized form for the specified degrees of freedom, including the necessary summations over all spin indices and real space positions. 

The resulting Hamiltonian is:

$$
\hat{H}^{int} = U_d \sum_{R_i} n_{d,\uparrow}(R_i) n_{d,\downarrow}(R_i) + \frac{U_p}{2} \sum_{R_i} [n_{p_x,\uparrow}(R_i+\hat{x}/2) n_{p_x,\downarrow}(R_i+\hat{x}/2) + n_{p_y,\uparrow}(R_i+\hat{y}/2) n_{p_y,\downarrow}(R_i+\hat{y}/2)] \\ 
+ V_{pd} \sum_{R_i, s, s^{\prime}} [n_{d,s}(R_i) (n_{p_x,s^{\prime}}(R_i+\hat{x}/2) + n_{p_x,s^{\prime}}(R_i-\hat{x}/2) + n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_y,s^{\prime}}(R_i-\hat{y}/2)) ] \\
+ V_{pp} \sum_{R_i, s, s^{\prime}} [(n_{p_x,s}(R_i+\hat{x}/2) + n_{p_x,s}(R_i-\hat{x}/2)) (n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_y,s^{\prime}}(R_i-\hat{y}/2))]
$$

Where $n_{\alpha,s}(R_i) = c_{\alpha,s}^\dagger(R_i) c_{\alpha,s}(R_i)$ is the density of a particle with orbital $\alpha$ and spin $s$ at site $R_i$. The spin index $s$ and $s^{\prime}$ can take on values of $\uparrow$ (spin up) or $\downarrow$ (spin down). The orbital index $\alpha$ can take on values of $d$, $p_x$, or $p_y$ which correspond to the $d$ orbital in the Cu atom, $p_x$ orbital in the O atom, and $p_y$ orbital in the O atom, respectively. $U_d$ is the onsite interaction strength of the $d$ orbital, $U_p$ is the onsite interaction strength of the $p$ orbitals, $V_{pd}$ is the nearest neighbor interaction strength between the $p$ and $d$ orbitals, and $V_{pp}$ is the nearest neighbor interaction strength between the $p_x$ and $p_y$ orbitals.

## Convert noninteracting Hamiltonian in real space to momentum space (lattice version)
**Prompt:**  
Now you will be instructed to convert the Kinetic Hamiltonian $H_0$ in the second quantized form from the basis in real space to the basis in momentum space.  
To do that, you should apply the Fourier transformation to $c_{\alpha,s}^\dagger(R_i)$ in the real space to the $c_{\alpha,s}^\dagger(k)$ in the momentum space, which is defined as $c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over all sites in the entire real space. You should follow the EXAMPLE below to apply the Fourier transformation. Note that $t_{pp}$ and $t_{pd}$ have no position dependent now.  
Recall that 
$$H_0 = -t_{pd}\sum_{R_i, s} ( c_{d,s}^\dagger(R_i) c_{p_x,s}(R_i+\hat{x}/2) + c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{d,s}(R_i) 
+ c_{d,s}^\dagger(R_i) c_{p_x,s}(R_i-\hat{x}/2) + c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{d,s}(R_i)
+ c_{d,s}^\dagger(R_i) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{d,s}(R_i)
+ c_{d,s}^\dagger(R_i) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{d,s}(R_i) )
-t_{pp}\sum_{R_i, s} ( c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{p_x,s}(R_i+\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i+\hat{x}/2) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{p_x,s}(R_i+\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{p_y,s}(R_i+\hat{y}/2) + c_{p_y,s}^\dagger(R_i+\hat{y}/2) c_{p_x,s}(R_i-\hat{x}/2) 
+ c_{p_x,s}^\dagger(R_i-\hat{x}/2) c_{p_y,s}(R_i-\hat{y}/2) + c_{p_y,s}^\dagger(R_i-\hat{y}/2) c_{p_x,s}(R_i-\hat{x}/2) )$$
Express the Kinetic Hamiltonian $H_0$ in terms of $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$. Simplify any summation index if possible, and notice that $k\cdot \hat{x}=k_x$ and $k\cdot \hat{y}=k_y$. 

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):  
$c_{\alpha,s}(k)$ : electron annihilation operator at momentum $k$, spin $s$ and orbital $\alpha$
$c_{\alpha,s}^\dagger(k)$ : electron creation operator at momentum $k$, spin $s$ and orbital $\alpha$
$N$ : number of the unit cells in the real space  

===
EXAMPLE:  
Write a Kinetic Hamiltonian $\hat{H}$ in the second quantized form in the real space, $\hat{H}=\sum_{i,j} t(R_i-R_j) c^\dagger(R_i) c(R_j)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transformation $c^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transformation $c^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}$, we get  
$$\hat{H} = \sum_{i,j} t(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c(k_2) e^{i k_2 \cdot R_j} =\frac{1}{N} \sum_{i,j}\sum_{k_1,k_2} c^\dagger(k_1)  c(k_2)  e^{-i k_1\cdot R_i} e^{i k_2 \cdot R_j} t(R_i-R_j) $$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}=\frac{1}{N} \sum_{i,n} \sum_{k_1,k_2} c^\dagger(k_1)  c(k_2) t(n) e^{-i (k_1-k_2)\cdot R_i} e^{-i k_2 \cdot n}$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_2)\cdot R_i} = \delta(k_1,k_2)$, where $\delta(k_1,k_2)$ is the Kronecker delta function.  
therefore   
$$\hat{H}=\sum_{k_1,k_2} \sum_{n} t(n) e^{-i k_2 \cdot n} c^\dagger(k_1)  c(k_2) \delta(k_1,k_2)$$
Using the property of Kronecker delta function and sum over $k_2$, we obtain  
$$\hat{H}=\sum_{k_1} \sum_{n} t(n) e^{-i k_1 \cdot n} c^\dagger(k_1)  c(k_1) $$
For simplicity, we replace $k_1$ with $k$, we obtain  
$$\hat{H}=\sum_{k} \sum_{n} t(n) e^{-i k \cdot n} c^\dagger(k)  c(k)$$
If we define energy dispersion $E(k)=\sum_{n} t(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the Hamiltonian in the momentum space is 
$$\hat{H}=\sum_{k} E(k) c^\dagger(k)  c(k)$$

**Completion:**  
Let's follow the example provided and perform Fourier transformations to express the kinetic Hamiltonian $H_0$ in terms of the momentum-space operators $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$. 

For the transformation, we replace the position-space operators in the original Hamiltonian with the Fourier-transformed momentum-space operators. We also note that the translation by half the lattice constant amounts to a phase factor in the momentum space. In addition, the inverse Fourier transformation is given by $c_{\alpha,s}(R_i) = \frac{1}{\sqrt{N}} \sum_k c_{\alpha,s}(k) e^{-i k \cdot R_i}$.

We obtain:

$$
H_0 = -t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) e^{i k_x /2} + c_{p_x,s}^\dagger(k) c_{d,s}(k) e^{-i k_x /2}
+ c_{d,s}^\dagger(k) c_{p_x,s}(k) e^{-i k_x /2} + c_{p_x,s}^\dagger(k) c_{d,s}(k) e^{i k_x /2}
+ c_{d,s}^\dagger(k) c_{p_y,s}(k) e^{i k_y /2} + c_{p_y,s}^\dagger(k) c_{d,s}(k) e^{-i k_y /2}
+ c_{d,s}^\dagger(k) c_{p_y,s}(k) e^{-i k_y /2} + c_{p_y,s}^\dagger(k) c_{d,s}(k) e^{i k_y /2} )
-t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (k_x+k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (k_x+k_y) /2} 
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (k_x-k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (k_x-k_y) /2} 
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (-k_x+k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (-k_x+k_y) /2} 
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (-k_x-k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (-k_x-k_y) /2} )
$$

We have now successfully transformed the Hamiltonian $H_0$ from real-space to momentum-space. Note that the summations are over the momentum vectors within the first Brillouin zone, and that $k \cdot \hat{x}$ has been replaced with $k_x$ and $k \cdot \hat{y}$ has been replaced with $k_y$ as instructed. The orbital index $\alpha$ can take on values of $d$, $p_x$, or $p_y$. The spin index $s

$ can take on values of $\uparrow$ (spin up) or $\downarrow$ (spin down). The factor of $e^{i k \cdot R}$ from the Fourier transform gives us the momentum dependence of the Hamiltonian. $t_{pd}$ is the nearest neighbor hopping term between the $d$ and $p$ orbitals, and $t_{pp}$ is the nearest neighbor hopping term between the $p_x$ and $p_y$ orbitals.

## Mathematical simplify
**Prompt:**  
You will be instructed to simplify the Kinetic Hamiltonian $H_0$ in the momentum space.  
You should recall that the Kinetic Hamiltonian $H_0$ in the momentum space is $H_0 = -t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) e^{i k_x /2} + c_{p_x,s}^\dagger(k) c_{d,s}(k) e^{-i k_x /2}+ c_{d,s}^\dagger(k) c_{p_x,s}(k) e^{-i k_x /2} + c_{p_x,s}^\dagger(k) c_{d,s}(k) e^{i k_x /2}+ c_{d,s}^\dagger(k) c_{p_y,s}(k) e^{i k_y /2} + c_{p_y,s}^\dagger(k) c_{d,s}(k) e^{-i k_y /2}+ c_{d,s}^\dagger(k) c_{p_y,s}(k) e^{-i k_y /2} + c_{p_y,s}^\dagger(k) c_{d,s}(k) e^{i k_y /2} )-t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (k_x+k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (k_x+k_y) /2} + c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (k_x-k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (k_x-k_y) /2} + c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (-k_x+k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (-k_x+k_y) /2} + c_{p_x,s}^\dagger(k) c_{p_y,s}(k) e^{i (-k_x-k_y) /2} + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) e^{-i (-k_x-k_y) /2} )$.  
You should convert the exponential to the trigonometrical functions using Euler's formula.  
Return the simplified Kinetic Hamiltonian $H_0$ in the momentum space.  

**Completion:**  
Euler's formula allows us to express complex exponential functions in terms of sine and cosine, i.e., $e^{i \theta} = \cos(\theta) + i \sin(\theta)$. Using this, we can rewrite each exponential term in the Hamiltonian.

Let's simplify the kinetic Hamiltonian $H_0$ in momentum space by replacing the exponential functions with trigonometrical functions:

$$
H_0 = -t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) [\cos(k_x /2) + i \sin(k_x /2)] + c_{p_x,s}^\dagger(k) c_{d,s}(k) [\cos(-k_x /2) + i \sin(-k_x /2)] 
+ c_{d,s}^\dagger(k) c_{p_x,s}(k) [\cos(-k_x /2) + i \sin(-k_x /2)] + c_{p_x,s}^\dagger(k) c_{d,s}(k) [\cos(k_x /2) + i \sin(k_x /2)]
+ c_{d,s}^\dagger(k) c_{p_y,s}(k) [\cos(k_y /2) + i \sin(k_y /2)] + c_{p_y,s}^\dagger(k) c_{d,s}(k) [\cos(-k_y /2) + i \sin(-k_y /2)]
+ c_{d,s}^\dagger(k) c_{p_y,s}(k) [\cos(-k_y /2) + i \sin(-k_y /2)] + c_{p_y,s}^\dagger(k) c_{d,s}(k) [\cos(k_y /2) + i \sin(k_y /2)] )
-t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) [\cos((k_x+k_y) /2) + i \sin((k_x+k_y) /2)] + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) [\cos(-(k_x+k_y) /2) + i \sin(-(k_x+k_y) /2)] 
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) [\cos((k_x-k_y) /2) + i \sin((k_x-k_y) /2)] + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) [\cos(-(k_x-k_y) /2) + i \sin(-(k_x-k_y) /2)]
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) [\cos((-k_x+k_y) /2) + i \sin((-k_x+k_y) /2)] + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) [\cos(-(-k_x+k_y) /2) + i \sin(-(-k_x+k_y) /2)]
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) [\cos((-k_x-k_y) /2) + i \sin((-k_x-k_y) /2)] + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) [\cos(-(-k_x-k_y) /2) + i \sin(-(-k_x-k_y) /2)] )
$$

Next, we can use the property that $\cos(-\theta) = \cos(\theta)$ and $\sin(-\theta) = -\sin(\theta)$ to simplify further. This results in each of the cosine terms adding up to 2, and each of the sine terms cancelling out. The resulting simplified Hamiltonian is:

$$
H_0 = -2 t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) \cos(k_x /2) + c_{p_x,s}^\dagger(k) c_{d,s}(k) \cos(k_x /2) 
+ c_{d,s}^\dagger(k) c_{p_y,s}(k) \cos(k_y /2) + c_{p_y,s}^\dagger(k) c_{d,s}(k) \cos(k_y /2) )
-2 t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) \cos((k_x+k_y) /2) + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) \cos((k_x+k_y) /2)
+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) \cos((k_x-k_y) /2) + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) \cos((k_x-k_y) /2) )
$$

## Mathematical simplify
**Prompt:**  
You will be instructed to simplify the Kinetic Hamiltonian $H_0$ in the momentum space.  
You should recall that the Kinetic Hamiltonian $H_0$ in the momentum space is $H_0 = -2 t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) \cos(k_x /2) + c_{p_x,s}^\dagger(k) c_{d,s}(k) \cos(k_x /2) + c_{d,s}^\dagger(k) c_{p_y,s}(k) \cos(k_y /2) + c_{p_y,s}^\dagger(k) c_{d,s}(k) \cos(k_y /2) )-2 t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) \cos((k_x+k_y) /2) + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) \cos((k_x+k_y) /2)+ c_{p_x,s}^\dagger(k) c_{p_y,s}(k) \cos((k_x-k_y) /2) + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) \cos((k_x-k_y) /2) )$.  
You should simplify the trigonometrical functions after $t_{pp}$ using prosthaphaeresis.  
Return the simplified Kinetic Hamiltonian $H_0$ in the momentum space.  

**Completion:**  
The prosthaphaeresis formulas, also known as the product-to-sum formulas, are trigonometric identities that express products of trigonometric functions in terms of their sums and differences. These are given by:

1. $\cos(a) \cos(b) = \frac{1}{2}[\cos(a - b) + \cos(a + b)]$
2. $\sin(a) \sin(b) = \frac{1}{2}[\cos(a - b) - \cos(a + b)]$
3. $\sin(a) \cos(b) = \frac{1}{2}[\sin(a + b) + \sin(a - b)]$
4. $\cos(a) \sin(b) = \frac{1}{2}[\sin(a + b) - \sin(a - b)]$

In the given Hamiltonian, $H_0$, the terms after $t_{pp}$ can be simplified using the first formula. Let's apply the prosthaphaeresis formulas to these terms:

The term $\cos((k_x+k_y) /2) + \cos((k_x-k_y) /2)$ simplifies to $2 \cos(k_x/2) \cos(k_y/2)$.

Hence, the kinetic Hamiltonian $H_0$ in momentum space, after simplifying using prosthaphaeresis, is:

$$
H_0 = -2 t_{pd}\sum_{k, s} ( c_{d,s}^\dagger(k) c_{p_x,s}(k) \cos(k_x /2) + c_{p_x,s}^\dagger(k) c_{d,s}(k) \cos(k_x /2) + c_{d,s}^\dagger(k) c_{p_y,s}(k) \cos(k_y /2) + c_{p_y,s}^\dagger(k) c_{d,s}(k) \cos(k_y /2) )
$$

$$
-4 t_{pp}\sum_{k, s} ( c_{p_x,s}^\dagger(k) c_{p_y,s}(k) \cos(k_x/2) \cos(k_y/2) + c_{p_y,s}^\dagger(k) c_{p_x,s}(k) \cos(k_x/2) \cos(k_y/2))
$$

## Convert interacting Hamiltonian in real space to momentum space, first term (lattice version)
**Prompt:**  
Now you will be instructed to convert the interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form the basis in real space to the basis in momentum space. You will be instructed to perform the transformation to the first term with $U_d$.
To do that, you should apply the Fourier transformation to $c_{\alpha,s}^\dagger(R_i)$ in the real space to the $c_{\alpha,s}^\dagger(k)$ in the momentum space, which is defined as $c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over all sites in the entire real space, and $k$ is defined within fhe first Brillouin zone. You should follow the EXAMPLE below to apply the Fourier transformation. Note that the interaction $U_d$ is onsite.  
You should recall that the first term in $\hat{H}^{int}$ is
$$\hat{H}^{int} = U_d \sum_{R_i} n_{d,\uparrow}(R_i) n_{d,\downarrow}(R_i) $$
Express the first term in interacting Hamiltonian $\hat{H}^{int}$ with $U_d$ in terms of $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$. Simplify any summation index if possible.  

===  
EXAMPLE:  
Write an interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form in the real space, $\hat{H}^{int}=\sum_{s,s'}\sum_{i,j} U(R_i-R_j) c_s^\dagger(R_i) c_{s'}^\dagger(R_j) c_{s'}(R_j) c_s(R_i)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transformation $c_s^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c_s^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transformation $c_s^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_s^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is summed over the first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}^{int}$, we get  
$$\hat{H}^{int} = \sum_{s,s'}\sum_{i,j} U(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c_s^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c_{s'}^\dagger(k_2) e^{-i k_2 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_3} c_{s'}(k_3) e^{i k_3 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_4} c_s(k_4) e^{i k_4 \cdot R_i}=\sum_{s,s'}\sum_{i,j}\frac{1}{N^2}\sum_{k_1,k_2,k_3,k_4}U(R_i-R_j)c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot R_i} e^{-i(k_2-k_3)\cdot R_j}$$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}^{int}=\frac{1}{N^2} \sum_{j,n} \sum_{s,s'} \sum_{k_1,k_2,k_3,k_4} U(n) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot n} e^{-i(k_1-k_4+k_2-k_3)\cdot r_j }$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_4+k_2-k_3)\cdot R_i} = \sum\delta(k_1-k_4+k_2-k_3,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.  
Therefore,  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4} \sum_{n} U(n) e^{-i (k_1-k_4) \cdot n} c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$
If we define interaction in the momentum space $U(k)=\sum_{n} U(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the interacting Hamiltonian in the momentum space is  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$


**Completion:**  
Following the given example, let's apply the Fourier transformation to $\hat{H}^{int}$.

From the given definition of the Fourier transformation, we have
$$c_{d,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{d,s}^\dagger(R_i) e^{i k \cdot R_i}$$
Then, the inverse Fourier transformation can be obtained as
$$c_{d,s}^\dagger(R_i)= \frac{1}{\sqrt{N}} \sum_k c_{d,s}^\dagger(k) e^{-i k \cdot R_i}$$
Substituting into $\hat{H}^{int}$ gives
$$\hat{H}^{int} = U_d \sum_{R_i} \left[\frac{1}{N}\sum_{k_1} c_{d,\uparrow}^\dagger(k_1)e^{-i k_1 \cdot R_i}\right] \left[\frac{1}{N}\sum_{k_2} c_{d,\uparrow}(k_2)e^{i k_2 \cdot R_i}\right] \left[\frac{1}{N}\sum_{k_3} c_{d,\downarrow}^\dagger(k_3)e^{-i k_3 \cdot R_i}\right] \left[\frac{1}{N}\sum_{k_4} c_{d,\downarrow}(k_4)e^{i k_4 \cdot R_i}\right]$$
This simplifies to
$$\hat{H}^{int} = \frac{U_d}{N^2} \sum_{R_i} \sum_{k_1,k_2,k_3,k_4} c_{d,\uparrow}^\dagger(k_1) c_{d,\uparrow}(k_2) c_{d,\downarrow}^\dagger(k_3) c_{d,\downarrow}(k_4)e^{-i(k_1-k_2+k_3-k_4)\cdot R_i}.$$

By the definition of the Kronecker delta, we have
$$\frac{1}{N}\sum_{i} e^{-i (k_1-k_2+k_3-k_4)\cdot R_i} = \sum\delta(k_1-k_2+k_3-k_4,G),$$
where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.

Finally, the transformed interacting Hamiltonian in the momentum space is
$$\hat{H}^{int} = \frac{U_d}{N}\sum_{k_1,k_2,k_3,k_4} c_{d,\uparrow}^\dagger(k_1)c_{d,\uparrow}(k_2)c_{d,\downarrow}^\dagger(k_3)c_{d,\downarrow}(k_4) \sum_{G} \delta(k_1-k_2+k_3-k_4,G).$$


## Convert interacting Hamiltonian in real space to momentum space, second term (lattice version)
**Prompt:**  
Now you will be instructed to convert the interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form the basis in real space to the basis in momentum space. You will be instructed to perform the transformation to the second term with $U_p$.
To do that, you should apply the Fourier transformation to $c_{\alpha,s}^\dagger(R_i)$ in the real space to the $c_{\alpha,s}^\dagger(k)$ in the momentum space, which is defined as $c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over all sites in the entire real space, and $k$ is defined within fhe first Brillouin zone. You should follow the EXAMPLE below to apply the Fourier transformation. Note that the interaction $U_p$ is onsite.  
You should recall that the second term in $\hat{H}^{int}$ is
$$ \frac{U_p}{2} \sum_{R_i} [n_{p_x,\uparrow}(R_i+\hat{x}/2) n_{p_x,\downarrow}(R_i+\hat{x}/2) + n_{p_y,\uparrow}(R_i+\hat{y}/2) n_{p_y,\downarrow}(R_i+\hat{y}/2)] $$
Express the second term in interacting Hamiltonian $\hat{H}^{int}$ with $U_p$ in terms of $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$. Simplify any summation index if possible.  

===  
EXAMPLE:  
Write an interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form in the real space, $\hat{H}^{int}=\sum_{s,s'}\sum_{i,j} U(R_i-R_j) c_s^\dagger(R_i) c_{s'}^\dagger(R_j) c_{s'}(R_j) c_s(R_i)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transformation $c_s^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c_s^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transformation $c_s^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_s^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is summed over the first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}^{int}$, we get  
$$\hat{H}^{int} = \sum_{s,s'}\sum_{i,j} U(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c_s^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c_{s'}^\dagger(k_2) e^{-i k_2 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_3} c_{s'}(k_3) e^{i k_3 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_4} c_s(k_4) e^{i k_4 \cdot R_i}=\sum_{s,s'}\sum_{i,j}\frac{1}{N^2}\sum_{k_1,k_2,k_3,k_4}U(R_i-R_j)c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot R_i} e^{-i(k_2-k_3)\cdot R_j}$$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}^{int}=\frac{1}{N^2} \sum_{j,n} \sum_{s,s'} \sum_{k_1,k_2,k_3,k_4} U(n) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot n} e^{-i(k_1-k_4+k_2-k_3)\cdot r_j }$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_4+k_2-k_3)\cdot R_i} = \sum\delta(k_1-k_4+k_2-k_3,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.  
Therefore,  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4} \sum_{n} U(n) e^{-i (k_1-k_4) \cdot n} c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$
If we define interaction in the momentum space $U(k)=\sum_{n} U(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the interacting Hamiltonian in the momentum space is  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$

**Completion:**  
Let's start by transforming $n_{p_x,\uparrow}(R_i+\hat{x}/2)$ and $n_{p_x,\downarrow}(R_i+\hat{x}/2)$ from the real space to the momentum space. The transformation for $n_{p_x,\uparrow}(R_i+\hat{x}/2)$ is similar to the transformation for $n_{p_x,\downarrow}(R_i+\hat{x}/2)$, so we will only show the detailed steps for $n_{p_x,\uparrow}(R_i+\hat{x}/2)$. 

The Fourier transformation for $c_{\alpha,s}^\dagger(R_i)$ and $c_{\alpha,s}(R_i)$ is given by 
$$c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i},$$
and
$$c_{\alpha,s}(R_i) = \frac{1}{\sqrt{N}} \sum_k c_{\alpha,s}(k) e^{-i k \cdot R_i},$$
respectively.

We apply these transformations to $n_{p_x,\uparrow}(R_i+\hat{x}/2)=c_{p_x,\uparrow}^\dagger(R_i+\hat{x}/2) c_{p_x,\uparrow}(R_i+\hat{x}/2)$, and we get
$$ n_{p_x,\uparrow}(R_i+\hat{x}/2)= \frac{1}{N} \sum_{k,k'} c_{p_x,\uparrow}^\dagger(k) c_{p_x,\uparrow}(k') e^{i k \cdot (R_i+\hat{x}/2)} e^{-i k' \cdot (R_i+\hat{x}/2)}.$$

Similar transformations can be applied to $n_{p_y,\uparrow}(R_i+\hat{y}/2)$ and $n_{p_y,\downarrow}(R_i+\hat{y}/2)$.

Now, let's substitute the transformations into the second term in the Hamiltonian:

$$ \frac{U_p}{2} \sum_{R_i} [n_{p_x,\uparrow}(R_i+\hat{x}/2) n_{p_x,\downarrow}(R_i+\hat{x}/2) + n_{p_y,\uparrow}(R_i+\hat{y}/2) n_{p_y,\downarrow}(R_i+\hat{y}/2)] $$

And we obtain:

$$ \hat{H}_{int}^{(2)} = \frac{U_p}{2N^2} \sum_{R_i} \sum_{k_1,k_2,k_3,k_4} \{c_{p_x,\uparrow}^\dagger(k_1) c_{p_x,\uparrow}(k_2) c_{p_x,\downarrow}^\dagger(k_3) c_{p_x,\downarrow}(k_4) [e^{i (k_1-k_2) \cdot (R_i+\hat{x}/2)}e^{i (k_3-k_4) \cdot (R_i+\hat{x}/2)}] $$
$$+ c_{p_y,\uparrow}^\dagger(k_1) c_{p_y,\uparrow}(k_2) c_{p_y,\downarrow}^\dagger(k_3) c_{p_y,\downarrow}(k_4) [e^{i (k_1-k_2) \cdot (

R_i+\hat{y}/2)}e^{i (k_3-k_4) \cdot (R_i+\hat{y}/2)}] \}.$$

Using the Kronecker delta, the Hamiltonian can be simplified to:

$$ \hat{H}_{int}^{(2)} = \frac{U_p}{2N} \sum_{k_1,k_2,k_3,k_4} \{c_{p_x,\uparrow}^\dagger(k_1) c_{p_x,\uparrow}(k_2) c_{p_x,\downarrow}^\dagger(k_3) c_{p_x,\downarrow}(k_4) \sum_{G} \delta(k_1-k_2+k_3-k_4,G) $$
$$+ c_{p_y,\uparrow}^\dagger(k_1) c_{p_y,\uparrow}(k_2) c_{p_y,\downarrow}^\dagger(k_3) c_{p_y,\downarrow}(k_4) \sum_{G} \delta(k_1-k_2+k_3-k_4,G) \}.$$

## Mathematical simplify
**Prompt:**  
Now you will be instructed to expand the product in the third term with $V_{pd}$ in $\hat{H}^{int}$.  
You should recall that the third term in $\hat{H}^{int}$ is
$$ V_{pd} \sum_{R_i, s, s^{\prime}} [n_{d,s}(R_i) (n_{p_x,s^{\prime}}(R_i+\hat{x}/2) + n_{p_x,s^{\prime}}(R_i-\hat{x}/2) + n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_y,s^{\prime}}(R_i-\hat{y}/2)) ]$$  
Express the third term in interacting Hamiltonian $\hat{H}^{int}$ with $V_{pd}$ in the expanded form.

**Completion:**  
The term you're referring to involves the interaction between $d$ and $p$ orbitals. To expand this term, we just have to distribute the terms inside the parentheses. The result is:

$$ V_{pd} \sum_{R_i, s, s^{\prime}} [n_{d,s}(R_i)n_{p_x,s^{\prime}}(R_i+\hat{x}/2) + n_{d,s}(R_i)n_{p_x,s^{\prime}}(R_i-\hat{x}/2) + n_{d,s}(R_i)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{d,s}(R_i)n_{p_y,s^{\prime}}(R_i-\hat{y}/2)] $$

Here, the sum is taken over all lattice sites $R_i$, and all spin orientations $s$ and $s'$. This expansion represents the contribution to the interaction Hamiltonian from the interaction between $d$ and $p$ orbitals located at different positions.

## Convert interacting Hamiltonian in real space to momentum space, third term (lattice version)
**Prompt:**  
Now you will be instructed to convert the interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form the basis in real space to the basis in momentum space. You will be instructed to perform the transformation to the third term with $V_{pd}$.
To do that, you should apply the Fourier transformation to $c_{\alpha,s}^\dagger(R_i)$ in the real space to the $c_{\alpha,s}^\dagger(k)$ in the momentum space, which is defined as $c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over all sites in the entire real space, and $k$ is defined within fhe first Brillouin zone. You should follow the EXAMPLE below to apply the Fourier transformation. Note that the interaction $V_{pd}$ is onsite.  
You should recall that the third term in $\hat{H}^{int}$ is
$$ V_{pd} \sum_{R_i, s, s^{\prime}} [n_{d,s}(R_i)n_{p_x,s^{\prime}}(R_i+\hat{x}/2) + n_{d,s}(R_i)n_{p_x,s^{\prime}}(R_i-\hat{x}/2) + n_{d,s}(R_i)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{d,s}(R_i)n_{p_y,s^{\prime}}(R_i-\hat{y}/2)] $$  
Express the third term in interacting Hamiltonian $\hat{H}^{int}$ with $V_{pd}$ in terms of $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$. Simplify any summation index if possible.  

===  
EXAMPLE:  
Write an interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form in the real space, $\hat{H}^{int}=\sum_{s,s'}\sum_{i,j} U(R_i-R_j) c_s^\dagger(R_i) c_{s'}^\dagger(R_j) c_{s'}(R_j) c_s(R_i)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transformation $c_s^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c_s^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transformation $c_s^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_s^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is summed over the first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}^{int}$, we get  
$$\hat{H}^{int} = \sum_{s,s'}\sum_{i,j} U(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c_s^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c_{s'}^\dagger(k_2) e^{-i k_2 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_3} c_{s'}(k_3) e^{i k_3 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_4} c_s(k_4) e^{i k_4 \cdot R_i}=\sum_{s,s'}\sum_{i,j}\frac{1}{N^2}\sum_{k_1,k_2,k_3,k_4}U(R_i-R_j)c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot R_i} e^{-i(k_2-k_3)\cdot R_j}$$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}^{int}=\frac{1}{N^2} \sum_{j,n} \sum_{s,s'} \sum_{k_1,k_2,k_3,k_4} U(n) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot n} e^{-i(k_1-k_4+k_2-k_3)\cdot r_j }$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_4+k_2-k_3)\cdot R_i} = \sum\delta(k_1-k_4+k_2-k_3,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.  
Therefore,  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4} \sum_{n} U(n) e^{-i (k_1-k_4) \cdot n} c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$
If we define interaction in the momentum space $U(k)=\sum_{n} U(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the interacting Hamiltonian in the momentum space is  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$

**Completion:**  
Following the example given and the instruction to apply Fourier transformation to the third term with $V_{pd}$, we start by recalling that $n_{\alpha,s}(R_i)$ is equal to $c_{\alpha,s}^\dagger(R_i) c_{\alpha,s}(R_i)$. Then, we apply the Fourier transformation to the operators:

$$
c_{\alpha,s}^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_{\alpha,s}^\dagger(k) e^{-i k \cdot R_i}
$$
$$
c_{\alpha,s}(R_i) = \frac{1}{\sqrt{N}} \sum_k c_{\alpha,s}(k) e^{i k \cdot R_i}
$$

We substitute these transformations into the third term with $V_{pd}$:

$$
V_{pd} \sum_{R_i, s, s^{\prime}} \Big[ c_{d,s}^\dagger(R_i)c_{d,s}(R_i)c_{p_x,s^{\prime}}^\dagger(R_i+\hat{x}/2)c_{p_x,s^{\prime}}(R_i+\hat{x}/2)
+ c_{d,s}^\dagger(R_i)c_{d,s}(R_i)c_{p_x,s^{\prime}}^\dagger(R_i-\hat{x}/2)c_{p_x,s^{\prime}}(R_i-\hat{x}/2)
$$
$$
+ c_{d,s}^\dagger(R_i)c_{d,s}(R_i)c_{p_y,s^{\prime}}^\dagger(R_i+\hat{y}/2)c_{p_y,s^{\prime}}(R_i+\hat{y}/2)
+ c_{d,s}^\dagger(R_i)c_{d,s}(R_i)c_{p_y,s^{\prime}}^\dagger(R_i-\hat{y}/2)c_{p_y,s^{\prime}}(R_i-\hat{y}/2) \Big]
$$

After Fourier transformation, this becomes:

$$
V_{pd} \sum_{s, s^{\prime}} \frac{1}{N^2} \sum_{k_1,k_2,k_3,k_4} \Big[ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_x,s^{\prime}}^\dagger(k_3)c_{p_x,s^{\prime}}(k_4)e^{-i(k_1-k_2)\cdot R_i}e^{-i(k_3-k_4)\cdot(R_i+\hat{x}/2)}
$$
$$
+ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_x,s^{\prime}}^\dagger(k_3)c_{p_x,s^{\prime}}(k_4)e^{-i(k_1-k_2)\cdot R_i}e^{-i(k_3-k_4)\cdot(R_i-\hat{x}/2)}
$$
$$
+ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_y,s^{\prime}}^\dagger(k_3)c_{p_y,s^{\prime}}(k_4)e^{-i(k_1-k_2)\cdot R_i}e^{-i(k_3-k_4)\cdot(R_i+\hat{y}/2)}
$$
$$
+ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_y

,s^{\prime}}^\dagger(k_3)c_{p_y,s^{\prime}}(k_4)e^{-i(k_1-k_2)\cdot R_i}e^{-i(k_3-k_4)\cdot(R_i-\hat{y}/2)} \Big]
$$

Next, we observe that the quantity inside the square brackets involves two terms for each of $p_x$ and $p_y$ orbitals, which differ by a sign. Therefore, we can combine them:

$$
V_{pd} \sum_{s, s^{\prime}} \frac{1}{N^2} \sum_{k_1,k_2,k_3,k_4} \Big[ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_x,s^{\prime}}^\dagger(k_3)c_{p_x,s^{\prime}}(k_4)e^{-i(k_1-k_2+k_3-k_4)\cdot R_i}2\cos\left(\frac{k_3-k_4}{2}\cdot \hat{x}\right)
$$
$$
+ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_y,s^{\prime}}^\dagger(k_3)c_{p_y,s^{\prime}}(k_4)e^{-i(k_1-k_2+k_3-k_4)\cdot R_i}2\cos\left(\frac{k_3-k_4}{2}\cdot \hat{y}\right) \Big]
$$

Now, similar to the given example, we can make use of the identity $\frac{1}{N}\sum_{i} e^{-i (k_1-k_2+k_3-k_4)\cdot R_i} = \sum\delta(k_1-k_2+k_3-k_4,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space. 

Therefore, the third term in the momentum space will be:

$$
\hat{H}_{pd}^{int} = 2V_{pd} \sum_{s, s^{\prime}} \frac{1}{N} \sum_{k_1,k_2,k_3,k_4} \Big[ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_x,s^{\prime}}^\dagger(k_3)c_{p_x,s^{\prime}}(k_4)\cos\left(\frac{k_3-k_4}{2}\cdot \hat{x}\right)
$$
$$
+ c_{d,s}^\dagger(k_1)c_{d,s}(k_2)c_{p_y,s^{\prime}}^\dagger(k_3)c_{p_y,s^{\prime}}(k_4)\cos\left(\frac{k_3-k_4}{2}\cdot \hat{y}\right) \Big] \sum_{G} \delta(k_1-k_2+k_3-k_4,G)
$$

This is the third term with $V_{pd}$ in the momentum space. Please note that the exact form may depend on the details of the lattice structure, especially the definitions of $\hat{x}$ and $\hat{y}$ in the momentum space.

## Mathematical simplify
**Prompt:**  
Now you will be instructed to expand the product in the fourth term with $V_{pd}$ in $\hat{H}^{int}$.  
You should recall that the fourth term in $\hat{H}^{int}$ is
$$V_{pp} \sum_{R_i, s, s^{\prime}} [(n_{p_x,s}(R_i+\hat{x}/2) + n_{p_x,s}(R_i-\hat{x}/2)) (n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_y,s^{\prime}}(R_i-\hat{y}/2))]$$  
Express the fourth term in interacting Hamiltonian $\hat{H}^{int}$ with $V_{pp}$ in the expanded form.

**Completion:**  
The fourth term of the interacting Hamiltonian $\hat{H}^{int}$ with $V_{pp}$ is given by the equation:

$$V_{pp} \sum_{R_i, s, s^{\prime}} [(n_{p_x,s}(R_i+\hat{x}/2) + n_{p_x,s}(R_i-\hat{x}/2)) (n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_y,s^{\prime}}(R_i-\hat{y}/2))]$$ 

Here, $n_{\alpha,s}(R_i)$ is equal to $c_{\alpha,s}^\dagger(R_i) c_{\alpha,s}(R_i)$ where $\alpha$ is the orbital (either $p_x$ or $p_y$ in this case), $s$ is the spin, and $R_i$ is the position.

We can expand the product in the equation:

$$V_{pp} \sum_{R_i, s, s^{\prime}} [n_{p_x,s}(R_i+\hat{x}/2)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_x,s}(R_i+\hat{x}/2)n_{p_y,s^{\prime}}(R_i-\hat{y}/2) $$ 
$$+ n_{p_x,s}(R_i-\hat{x}/2)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_x,s}(R_i-\hat{x}/2)n_{p_y,s^{\prime}}(R_i-\hat{y}/2)] $$

This is the expanded form of the fourth term in $\hat{H}^{int}$ with $V_{pp}$. Each term represents the interaction between the $p_x$ and $p_y$ orbitals with either the same or different spin at different lattice sites. Note that $\hat{x}$ and $\hat{y}$ are the unit vectors in the $x$ and $y$ directions, respectively.

## Convert interacting Hamiltonian in real space to momentum space, fourth term (lattice version)
**Prompt:**  
Now you will be instructed to convert the interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form the basis in real space to the basis in momentum space. You will be instructed to perform the transformation to the fourth term with $V_{pp}$.
To do that, you should apply the Fourier transformation to $c_{\alpha,s}^\dagger(R_i)$ in the real space to the $c_{\alpha,s}^\dagger(k)$ in the momentum space, which is defined as $c_{\alpha,s}^\dagger(k)= \frac{1}{\sqrt{N}} \sum_i c_{\alpha,s}^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over all sites in the entire real space, and $k$ is defined within fhe first Brillouin zone. You should follow the EXAMPLE below to apply the Fourier transformation. Note that the interaction $V_{pp}$ is onsite.  
You should recall that the fourth term in $\hat{H}^{int}$ is
$$ V_{pp} \sum_{R_i, s, s^{\prime}} [n_{p_x,s}(R_i+\hat{x}/2)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_x,s}(R_i+\hat{x}/2)n_{p_y,s^{\prime}}(R_i-\hat{y}/2) $$ 
$$+ n_{p_x,s}(R_i-\hat{x}/2)n_{p_y,s^{\prime}}(R_i+\hat{y}/2) + n_{p_x,s}(R_i-\hat{x}/2)n_{p_y,s^{\prime}}(R_i-\hat{y}/2)] $$
Express the fourth term in interacting Hamiltonian $\hat{H}^{int}$ with $V_{pp}$ in terms of $c_{\alpha,s}(k)$ and $c_{\alpha,s}^\dagger(k)$ in full. Simplify any summation index if possible.  

===  
EXAMPLE:  
Write an interacting Hamiltonian $\hat{H}^{int}$ in the second quantized form in the real space, $\hat{H}^{int}=\sum_{s,s'}\sum_{i,j} U(R_i-R_j) c_s^\dagger(R_i) c_{s'}^\dagger(R_j) c_{s'}(R_j) c_s(R_i)$, where $i,j$ are summed over the entire real space.  
Define the Fourier transformation $c_s^\dagger(k)=\frac{1}{\sqrt{N}} \sum_{i}c_s^\dagger(R_i) e^{i k \cdot R_i}$, where $i$ is integrated over the entire real space containing $N$ unit cells, $N$ is the number of unit cells.  
This leads to the inverse Fourier transformation $c_s^\dagger(R_i) = \frac{1}{\sqrt{N}} \sum_k c_s^\dagger(k) e^{-i k \cdot R_i}$, where $k$ is summed over the first Brillouin zone.  
Thus, substitute $c^\dagger(R_i)$ and $c(R_j)$ into $\hat{H}^{int}$, we get  
$$\hat{H}^{int} = \sum_{s,s'}\sum_{i,j} U(R_i-R_j) \frac{1}{\sqrt{N}} \sum_{k_1} c_s^\dagger(k_1) e^{-i k_1 \cdot R_i} \frac{1}{\sqrt{N}} \sum_{k_2} c_{s'}^\dagger(k_2) e^{-i k_2 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_3} c_{s'}(k_3) e^{i k_3 \cdot R_j} \frac{1}{\sqrt{N}} \sum_{k_4} c_s(k_4) e^{i k_4 \cdot R_i}=\sum_{s,s'}\sum_{i,j}\frac{1}{N^2}\sum_{k_1,k_2,k_3,k_4}U(R_i-R_j)c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot R_i} e^{-i(k_2-k_3)\cdot R_j}$$
Now make a replacement by defining $n= R_i-R_j$  
The Hamiltonian become  
$$\hat{H}^{int}=\frac{1}{N^2} \sum_{j,n} \sum_{s,s'} \sum_{k_1,k_2,k_3,k_4} U(n) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4)e^{-i(k_1-k_4)\cdot n} e^{-i(k_1-k_4+k_2-k_3)\cdot r_j }$$
Because $\frac{1}{N}\sum_{i} e^{-i (k_1-k_4+k_2-k_3)\cdot R_i} = \sum\delta(k_1-k_4+k_2-k_3,G)$, where $\delta(..,..)$ is the Kronecker delta function, and $G$ is the all reciprocal lattices in the momentum space.  
Therefore,  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4} \sum_{n} U(n) e^{-i (k_1-k_4) \cdot n} c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$
If we define interaction in the momentum space $U(k)=\sum_{n} U(n) e^{-i k \cdot n}$, where $n$ is the summation of all hopping pairs, the interacting Hamiltonian in the momentum space is  
$$\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$$

**Completion:**  



# Hartree-Fock approximation
## Wick’s theorem
Now You will be instructed to perform a Hartree-Fock approximation to expand the interaction term $\hat{H}^{int}$. You will be instructed to perform the transformation to the first term with $U_d$.
You should use Wick's theorem to expand the four-fermion term in $\hat{H}^{int}$ into quadratic terms. You should strictly follow the EXAMPLE below to expand using Wick's theorem, and be extremely cautious about the order of the index and sign before each term.  
You should only preserve the normal terms. Here, the normal terms mean the product of a creation operator and an annihilation operator.  
You should recall that $\hat{H}^{int}=\frac{1}{N}\sum_{s,s'}\sum_{k_1,k_2,k_3,k_4}  U(k_1-k_4) c_s^\dagger(k_1)c_{s'}^\dagger(k_2)c_{s'}(k_3)c_s(k_4) \sum_{G} \delta(k_1-k_4+k_2-k_3,G)$.  
Return the expanded interaction term after Hartree-Fock approximation $\hat{H}^{int,HF,U_d}$.

Use the following conventions for the symbols (You should also obey the conventions in all my previous prompts if you encounter undefined symbols. If you find it is never defined or has conflicts in the conventions, you should stop and let me know):  
$\langle c_{\alpha,s}^\dagger(k_1) c_{\alpha^{\prime},s^{\prime}}(k_2) \rangle$ : expectation of $c_{\alpha,s}^\dagger(k_1) c_{\alpha^{\prime},s^{\prime}}(k_2)$ over the many-body ground states  
$\hat{H}^{int,HF,U_d}$ : first term in the interaction term after Hartree-Fock approximation  

===
EXAMPLE:  
For a four-fermion term $a_1^\dagger a_2^\dagger a_3 a_4$, using Wick's theorem and preserving only the normal terms. this is expanded as $a_1^\dagger a_2^\dagger a_3 a_4 = \langle a_1^\dagger a_4 \rangle a_2^\dagger a_3 + \langle a_2^\dagger a_3 \rangle a_1^\dagger a_4 - \langle a_1^\dagger a_4 \rangle \langle a_2^\dagger a_3\rangle - \langle a_1^\dagger a_3 \rangle a_2^\dagger a_4 - \langle a_2^\dagger a_4 \rangle a_1^\dagger a_3 + \langle a_1^\dagger a_3\rangle \langle a_2^\dagger a_4 \rangle$  
Be cautious about the order of the index and sign before each term here.